
investigacionApp.controller("PlantillaDocumentoController",["$log","$scope","ngToast","EstructuraOrganizacionService","PlantillaDocumentoService","SharedService",function(j,i,l,o,p,g){i.sharedService=g;i.tipos=["int","string","combobox"];i.plantillaDocumentos=[];i.plantillaDocumento={};var b=function(t){j.debug("GetEstructuraOrganizacion - Success");console.log("Respuesta :: ",t);i.organizaciones=t};var a=function(t){j.debug("GetEstructuraOrganizacion - Error");console.log("Respuesta :: ",t)};var r=function(t){j.debug("RegistrarPlantillaDocumento - Success");console.log("Respuesta :: ",t.body);i.GetPlantillaDocumento();i.plantillaDocumento={}};var s=function(t){j.debug("RegistrarPlantillaDocumento - Error");console.log("Respuesta :: ",t);i.plantillaDocumento={}};var c=function(t){j.debug("ActualizarPlantillaDocumento - Success");console.log("Respuesta :: ",t.body);i.GetPlantillaDocumento();i.plantillaDocumento={}};var h=function(t){j.debug("ActualizarPlantillaDocumento - Error");console.log("Respuesta :: ",t);i.plantillaDocumento={}};var f=function(t){j.debug("EliminarPlantillaDocumento - Success");console.log("Respuesta :: ",t.body);i.GetPlantillaDocumento();i.plantillaDocumento={}};var k=function(t){j.debug("EliminarPlantillaDocumento - Error");console.log("Respuesta :: ",t);i.plantillaDocumento={}};i.getEstructuraOrganizaciones=function(){o.getEstructuraOrganizaciones().then(b,a)};i.RegistrarPlantillaDocumento=function(){i.submitted=true;if(i.formRegistroSemestre.$valid){var t={setiqueta:i.plantillaDocumento.setiqueta,smodel:i.plantillaDocumento.smodel,sopciones:i.plantillaDocumento.sopciones===undefined?"":i.plantillaDocumento.sopciones,stipo:i.plantillaDocumento.stipo,sfacultad:i.facultad.snombreEstructuraOrganizacion,splantilla:m(i.plantillaDocumento.stipo,i.plantillaDocumento.smodel,i.plantillaDocumento.setiqueta,i.plantillaDocumento.sopciones),sdata:i.plantillaDocumento.sdata===undefined?"":i.plantillaDocumento.sdata.replace(/\n/g,","),suserCreacion:i.sharedService.nombreUsuario,sestado:"A"};p.RegistrarPlantillaDocumento(t).then(r,s);e("Registrado!","success")}else{console.log("No se registro Semestre :: ",i.semestre);e("Error al registrar!","danger");i.cancel()}};i.ActualizarPlantillaDocumento=function(){i.submitted=true;if(i.formRegistroSemestre.$valid){i.plantillaDocumento.sfacultad=i.facultad.snombreEstructuraOrganizacion;i.plantillaDocumento.suserModificacion=i.sharedService.nombreUsuario;p.ActualizarPlantillaDocumento(i.plantillaDocumento).then(c,h);e("Actualizado!","success")}else{console.log("No se registro Semestre :: ",i.semestre);e("Error al actualizar!","danger");i.cancel()}};i.EliminarPlantillaDocumento=function(t){i.plantillaDocumento=t;p.EliminarPlantillaDocumento(i.plantillaDocumento).then(f,k)};i.update=function(t){i.plantillaDocumento=t;i.facultad=n(i.plantillaDocumento.sfacultad)};i.Cerrar=function(){i.plantillaDocumento={}};i.changeTipo=function(t){if(t==="combobox"){i.textArea=true}else{i.textArea=false}};var n=function(u){var t={};angular.forEach(i.organizaciones,function(w,v){if(w.snombreEstructuraOrganizacion===u){t=w}});return t};var m=function(v,w,t,x){var u="";switch(v.toUpperCase()){case"INT":u='<label class="control-label col-md-2" >'+t+'</label><div class="col-md-4" >        <input ng-model="'+w+'" type="numeric" class="form-control" > </div>';break;case"STRING":u='<label class="control-label col-md-2" >'+t+'</label><div class="col-md-4" >        <input ng-model="'+w+'" type="text" class="form-control" > </div>';break;case"COMBOBOX":u='<label class="control-label col-md-2" >'+t+'</label><div class="col-md-4" >        <select ng-model="'+w+'" class="form-control" ng-options="opt as opt for opt in '+x+'" ></select> </div>';break;default:}return u};i.cancel=function(){i.semestre={}};var e=function(u,t){l.create({className:t,content:'<span class="alert-link">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+u+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>"})};i.rangoPaginas=[5,10,20,100];i.currentPage=1;i.currentRango=i.rangoPaginas[0];i.maxSize=5;i.total=0;i.numPages=function(){return Math.ceil(i.total/i.currentRango)};i.$watch("currentPage + currentRango",function(){i.GetPlantillaDocumento()});var d=function(t){j.debug("GetPlantillaDocumentoSuccess - Success");console.log("Respuesta :: ",t);i.plantillaDocumentos=[];i.plantillaDocumentos=t.lista;i.total=t.total};var q=function(t){j.debug("GetPlantillaDocumentoError - Error");console.log("Respuesta :: ",t)};i.GetPlantillaDocumento=function(){var t={currentPage:i.currentPage,rango:i.currentRango,total:i.total,filtro:i.buscar};p.GetPlantillaDocumento(t).then(d,q)};i.clickBuscar=function(){i.GetPlantillaDocumento()};i.GetPlantillaDocumento();i.getEstructuraOrganizaciones()}]);