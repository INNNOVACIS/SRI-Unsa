
investigacionApp.controller("ActividadesPendientesController",["$log","$scope","$location","FondoConcursableService","SRIUnsaConfig","SemestreService","TipoInvestigacionService","ActividadesPendientesService","TipoNivelService","EstructuraOrganizacionService","SharedService","UsuarioFlujoService",function(p,n,i,j,A,a,v,b,o,r,m,g){n.sharedService=m;n.loader=false;n.loadTable=false;var s=function(B){p.debug("GetTipoNivel - Success");console.log("Respuesta :: ",B);n.niveles=B;n.getEstructuraOrganizaciones()};var l=function(B){p.debug("GetTipoNivel - Error");console.log("Respuesta :: ",B)};var s=function(B){p.debug("GetTipoNivel - Success");n.niveles=B;n.getEstructuraOrganizaciones()};var l=function(B){p.debug("GetTipoNivel - Error");console.log("Respuesta :: ",B)};var e=function(B){p.debug("GetEstructuraOrganizacion - Success");console.log("Respuesta :: ",B);angular.forEach(B,function(D,C){angular.forEach(B,function(F,E){if(D.nidPadre===F.nidEstructuraOrganizacion){D.nombrePadre=F.snombreEstructuraOrganizacion}});angular.forEach(n.niveles,function(F,E){if(D.nidTipoNivel===F.nidTipoNivel){D.nombreTipoNivel=F.snombreTipoNivel}})});n.estructuraOrganizaciones=B};var d=function(B){p.debug("GetEstructuraOrganizacion - Error");console.log("Respuesta :: ",B)};var y=function(B){p.debug("GetFondo - Success");console.log("Respuesta :: ",B);n.fondos=B};var h=function(B){p.debug("GetFondo - Error",B);console.log("Respuesta :: ",B)};var u=function(B){p.debug("GetSemestre - Success");console.log("Respuesta :: ",B);n.semestres=B};var t=function(B){p.debug("GetSemestre - Error");console.log("Respuesta :: ",B)};var w=function(B){p.debug("GetInvestigacion - Success");console.log("Respuesta :: ",B);n.tipoInvestigaciones=B};var c=function(B){p.debug("GetInvestigacion - Error");console.log("Respuesta :: ",B)};var q=function(B){p.debug("CreateAndGetUsuarioFlujo - Success");console.log("Respuesta :: ",B)};var x=function(B){p.debug("CreateAndGetUsuarioFlujo - Error");console.log("Respuesta :: ",B)};n.getListaTipoNivel=function(){o.getListaTipoNivel().then(s,l)};n.getEstructuraOrganizaciones=function(){r.getEstructuraOrganizaciones().then(e,d)};n.getFondos=function(){j.getFondos().then(y,h)};n.getSemestres=function(){a.getSemestres().then(u,t)};n.getTipoInvestigacion=function(){v.getInvestigaciones().then(w,c)};n.CrearOrActualizarUsuarioFlujo=function(){var B={nidFlujoActor:A.DIDE,nidUsuario:n.sharedService.idUsuario};g.CreateAndGetUsuarioFlujo(B).then(q,x)};n.facultadChange=function(){n.departamento={};n.escuela={}};n.departamentoChange=function(){n.escuela={}};n.rangoPaginas=[5,10,20,100];n.currentPage=1;n.currentRango=n.rangoPaginas[0];n.maxSize=5;n.total=0;n.numPages=function(){return Math.ceil(n.total/n.currentRango)};n.$watch("currentPage + currentRango",function(){n.getActividades();n.row=(n.currentPage-1)*n.currentRango+1});var f=function(){var B={nidTipoActividadInvestigacion:(n.tipoInvestigacion===null||n.tipoInvestigacion===undefined)?"":n.tipoInvestigacion.nidTipoActividadInvestigacion,sfacultad:(n.facultad===null||n.facultad===undefined)?"":n.facultad.snombreEstructuraOrganizacion,sdepartamento:(n.departamento===null||n.departamento===undefined)?"":n.departamento.snombreEstructuraOrganizacion,sescuela:(n.escuela===null||n.escuela===undefined)?"":n.escuela.snombreEstructuraOrganizacion,ssemestre:(n.semestre===null||n.semestre===undefined)?"":n.semestre.snombreSemestre,sfondoConcursable:(n.fondo===null||n.fondo===undefined)?"":n.fondo.snombreFondoConcursable};return B};var k=function(B){n.actividadesPendientes=B.lista;n.total=B.total;n.loadTable=false};var z=function(B){console.log("error :: ",B)};n.getActividades=function(){var B={currentPage:n.currentPage,rango:n.currentRango,total:n.total,idUsuario:n.sharedService.idUsuario,idEstado:A.CREADO,idFlujoActor:A.DIDE,filtro:f()};b.paginacionActividades(B).then(k,z)};n.filtrar=function(){n.loadTable=true;setTimeout(function(){n.getActividades()},500)};n.getListaTipoNivel();n.getFondos();n.getSemestres();n.getTipoInvestigacion();n.CrearOrActualizarUsuarioFlujo();n.getActividades();n.verActividadById=function(B){n.loader=true;i.path("/actividad/Pendientes/"+B.idactividadinvestigacion)}}]);