
investigacionApp.controller("ActividadesPendientesController",["$log","$scope","$location","FondoConcursableService","SRIUnsaConfig","SemestreService","TipoInvestigacionService","ActividadesPendientesService","TipoNivelService","EstructuraOrganizacionService","SharedService","UsuarioFlujoService",function(o,m,h,i,y,a,s,b,n,q,l,g){m.sharedService=l;m.departamentos=[];m.loader=false;m.loadTable=false;var e=function(z){o.debug("GetEstructuraOrganizacion - Success");console.log("Respuesta :: ",z);angular.forEach(z,function(B,A){if(m.sharedService.usuarioLogin.idFacultad===B.nidPadre){m.departamentos.push(B)}})};var d=function(z){o.debug("GetEstructuraOrganizacion - Error");console.log("Respuesta :: ",z)};var w=function(z){o.debug("GetFondo - Success");console.log("Respuesta :: ",z);m.fondos=z};var j=function(z){o.debug("GetFondo - Error",z);console.log("Respuesta :: ",z)};var t=function(z){o.debug("GetSemestre - Success");console.log("Respuesta :: ",z);m.semestres=z};var r=function(z){o.debug("GetSemestre - Error");console.log("Respuesta :: ",z)};var u=function(z){o.debug("GetInvestigacion - Success");console.log("Respuesta :: ",z);m.tipoInvestigaciones=z};var c=function(z){o.debug("GetInvestigacion - Error");console.log("Respuesta :: ",z)};var p=function(z){o.debug("CreateAndGetUsuarioFlujo - Success");console.log("Respuesta :: ",z)};var v=function(z){o.debug("CreateAndGetUsuarioFlujo - Error");console.log("Respuesta :: ",z)};m.getEstructuraOrganizaciones=function(){q.getEstructuraOrganizaciones().then(e,d)};m.getFondos=function(){i.getFondos().then(w,j)};m.getSemestres=function(){a.getSemestres().then(t,r)};m.getTipoInvestigacion=function(){s.getInvestigaciones().then(u,c)};m.CrearOrActualizarUsuarioFlujo=function(){var z={nidFlujoActor:y.DIDE,nidUsuario:m.sharedService.idUsuario};g.CreateAndGetUsuarioFlujo(z).then(p,v)};m.rangoPaginas=[5,10,20,100];m.currentPage=1;m.currentRango=m.rangoPaginas[0];m.maxSize=5;m.total=0;m.numPages=function(){return Math.ceil(m.total/m.currentRango)};m.$watch("currentPage + currentRango",function(){m.getActividades();m.row=(m.currentPage-1)*m.currentRango+1});var f=function(){var z={nidTipoActividadInvestigacion:(m.tipoInvestigacion===null||m.tipoInvestigacion===undefined)?"":m.tipoInvestigacion.nidTipoActividadInvestigacion,sfacultad:(m.facultad===null||m.facultad===undefined)?"":m.facultad.snombreEstructuraOrganizacion,sdepartamento:(m.departamento===null||m.departamento===undefined)?"":m.departamento.snombreEstructuraOrganizacion,sescuela:(m.escuela===null||m.escuela===undefined)?"":m.escuela.snombreEstructuraOrganizacion,ssemestre:(m.semestre===null||m.semestre===undefined)?"":m.semestre.snombreSemestre,sfondoConcursable:(m.fondo===null||m.fondo===undefined)?"":m.fondo.snombreFondoConcursable};return z};var k=function(z){m.actividadesPendientes=z.lista;m.total=z.total;m.loadTable=false};var x=function(z){console.log("error :: ",z)};m.getActividades=function(){var z={currentPage:m.currentPage,rango:m.currentRango,total:m.total,idUsuario:m.sharedService.idUsuario,idEstado:y.CREADO,idFlujoActor:y.DIDE,filtro:f()};b.paginacionActividades(z).then(k,x)};m.filtrar=function(){m.loadTable=true;setTimeout(function(){m.getActividades()},500)};m.getFondos();m.getSemestres();m.getTipoInvestigacion();m.getEstructuraOrganizaciones();m.CrearOrActualizarUsuarioFlujo();m.getActividades();m.verActividadById=function(z){m.loader=true;h.path("/actividad/Pendientes/"+z.idactividadinvestigacion)}}]);