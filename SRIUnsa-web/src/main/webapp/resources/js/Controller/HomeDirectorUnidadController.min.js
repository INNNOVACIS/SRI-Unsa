
investigacionApp.controller("HomeDirectorUnidadController",["$log","$scope","UsuariosService","$location","HomeVicerectorService","SharedService",function(p,o,a,j,i,h){o.sharedService=h;o.users=[];o.usuario={};o.estados=["A","I"];o.idTipoInvestigacion=0;o.idDepartamento=0;o.currentTipo=0;o.currentDepartamento=false;var k=function(q){p.debug("GetTotalActivosInactivosByFacultad - Success");console.log("Respuesta :: ",q);l(q.body);o.docentes=q.body};var n=function(q){p.debug("GetTotalActivosInactivosByFacultad - Error");console.log("Respuesta :: ",q.body)};var g=function(q){p.debug("GetTotalActividadesByTipoActividadFacultad - Success");console.log("Respuesta :: ",q);o.tipoInvestigaciones=q.body};var b=function(q){p.debug("GetTotalActividadesByTipoActividadFacultad - Error");console.log("Respuesta :: ",q)};var f=function(q){p.debug("GetTotalActivosInactivosByDepartamento - Success");console.log("Respuesta :: ",q);o.docentesDepartamentos=q.body;angular.forEach(o.docentesDepartamentos,function(s,r){s.porcentajeActivo=c(s.ntotal,s.nactivos);s.porcentajeInactivo=c(s.ntotal,s.ninactivos)})};var d=function(q){p.debug("GetTotalActivosInactivosByDepartamento - Error");console.log("Respuesta :: ",q)};o.GetTotalActivosInactivosByDepartamento=function(r,q){i.GetTotalActivosInactivosByDepartamento(r,q).then(f,d)};o.GetTotalActivosInactivosByFacultad=function(q){a.GetTotalActivosInactivosByFacultad(q).then(k,n)};o.GetTotalActividadesByTipoActividadFacultad=function(q){i.GetTotalActividadesByTipoActividadFacultad(q).then(g,b)};o.registrar=function(q){console.log("USUARIO :: ",q);sessvars.docente=q;sessvars.idDocente=q.nidUsuario;o.sharedService.idDocente=sessvars.idDocente;o.sharedService.docente=sessvars.docente;sessvars.idUsuarioRegistrar=sessvars.idDocente;o.sharedService.idUsuarioRegistrar=sessvars.idUsuarioRegistrar;j.path("/homedocente")};o.setTipoInvestigacion=function(q){if(o.currentTipo===q.nidTipoActividadInvestigacion){o.currentTipo=0;o.idTipoInvestigacion=0}else{o.currentTipo=q.nidTipoActividadInvestigacion;o.idTipoInvestigacion=q.nidTipoActividadInvestigacion}o.sharedService.tipoInvestigacion=q;o.getUsuariosByPagina();o.GetTotalActivosInactivosByDepartamento(o.sharedService.usuarioLogin.idFacultad,o.idTipoInvestigacion)};o.filtrarDepartamento=function(q){if(q.nidEstructuraOrganizacion===o.currentDepartamento){o.currentDepartamento=0;o.idDepartamento=0}else{o.currentDepartamento=q.nidEstructuraOrganizacion;o.idDepartamento=q.nidEstructuraOrganizacion}o.getUsuariosByPagina()};var l=function(q){var r=q.nactivos+q.ninactivos;o.activo=(q.nactivos*100/r)+"%";o.inactivo=(q.ninactivos*100/r)+"%"};var c=function(s,r){var q="50%";if(s!==0){q=(r*100/s)+"%"}else{}return q};o.rangoPaginas=[5,10,20,100];o.currentPage=1;o.currentRango=o.rangoPaginas[0];o.maxSize=5;o.total=0;o.numPages=function(){return Math.ceil(o.total/o.currentRango)};o.$watch("currentPage + currentRango",function(){o.getUsuariosByPagina();o.row=(o.currentPage-1)*o.currentRango+1;console.log("FILA-INICIO :: ",o.idFila)});var e=function(q){p.debug("Get paginacionUsuario - Success");console.log("Respuesta :: ",q);o.users=[];o.users=q.lista;o.total=q.total};var m=function(q){p.debug("Get paginacionUsuario - Error");console.log("Respuesta :: ",q)};o.getUsuariosByPagina=function(){var q={currentPage:o.currentPage,rango:o.currentRango,total:o.total,filtro:o.buscar,idFacultad:o.sharedService.usuarioLogin.idFacultad,idDepartamento:o.idDepartamento,idTipoInvestigacion:o.idTipoInvestigacion};a.GetUsuariosColor(q).then(e,m)};o.clickBuscar=function(){o.getUsuariosByPagina()};o.getUsuariosByPagina();o.GetTotalActivosInactivosByDepartamento(o.sharedService.usuarioLogin.idFacultad,0);o.GetTotalActivosInactivosByFacultad(o.sharedService.usuarioLogin.idFacultad);o.GetTotalActividadesByTipoActividadFacultad(o.sharedService.usuarioLogin.idFacultad)}]);