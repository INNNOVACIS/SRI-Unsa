
investigacionApp.controller("UsuariosController",["$log","$scope","UsuariosService","EstructuraOrganizacionService","SharedService",function(p,o,a,k,j){o.sharedService=j;o.users=[];o.usuario={};o.estados=["A","I"];var n=function(q){p.debug("GetEstructuraOrganizacion - Success");console.log("Respuesta :: ",q);o.organizaciones=q};var d=function(q){p.debug("GetEstructuraOrganizacion - Error");console.log("Respuesta :: ",q)};var h=function(q){p.debug("Registrar Usuario - Success");console.log("Respuesta :: ",q.body);o.usuario={};o.getUsuariosByPagina()};var i=function(q){p.debug("RegistrarUsuario - Error");console.log("Respuesta :: ",q)};var g=function(q){p.debug("UpdateUsuario - Success");console.log("Respuesta :: ",q.body);o.getUsuariosByPagina()};var e=function(q){p.debug("UpdateUsuario - Error");console.log("Respuesta :: ",q)};var b=function(q){p.debug("DeleteUsuario - Success");console.log("Respuesta :: ",q.body);o.getUsuariosByPagina()};var c=function(q){p.debug("DeleteUsuario - Error");console.log("Respuesta :: ",q)};o.registrarUsuario=function(){var q={susuarioLogin:o.usuario.susuarioLogin,susuarioPassword:o.usuario.susuarioPassword,susuarioEmail:o.usuario.susuarioEmail,snombre:o.usuario.snombre,sapellido:o.usuario.sapellido,ndni:o.usuario.ndni,nidEstructuraOrganizacion:o.organizacion.nidPadre,nidDepartamento:o.organizacion.nidEstructuraOrganizacion,suserCreacion:o.sharedService.nombreUsuario,sestado:"A"};a.registrarUsuario(q).then(h,i)};o.updateUsuario=function(){var q={nidUsuario:o.usuario.nidUsuario,nidPersona:o.usuario.nidPersona,nidEstructuraOrganizacion:o.organizacion.nidPadre,nidDepartamento:o.organizacion.nidEstructuraOrganizacion,susuarioLogin:o.usuario.susuarioLogin,susuarioPassword:o.usuario.susuarioPassword,susuarioEmail:o.usuario.susuarioEmail,ndni:o.usuario.ndni,snombre:o.usuario.snombre,sapellido:o.usuario.sapellido,suserCreacion:o.usuario.suserCreacion,dfechaCreacion:o.usuario.dfechaCreacion,suserModificacion:o.sharedService.nombreUsuario,sestado:o.usuario.sestado};a.updateUsuario(q).then(g,e)};o.deleteUsuario=function(q){o.usuario=q;var r={nidUsuario:o.usuario.nidUsuario,nidPersona:o.usuario.nidPersona,nidEstructuraOrganizacion:o.usuario.nidEstructuraOrganizacion,susuarioLogin:o.usuario.susuarioLogin,susuarioPassword:o.usuario.susuarioPassword,susuarioEmail:o.usuario.susuarioEmail,ndni:o.usuario.ndni,snombre:o.usuario.snombre,sapellido:o.usuario.sapellido,suserCreacion:o.usuario.suserCreacion,dfechaCreacion:o.usuario.dfechaCreacion,suserModificacion:o.sharedService.nombreUsuario,sestado:o.usuario.sestado};a.deleteUsuario(r).then(b,c)};o.update=function(q){o.usuario=q;l(o.usuario.nidDepartamento)};o.Cerrar=function(){o.usuario={}};o.getEstructuraOrganizaciones=function(){k.getEstructuraOrganizaciones().then(n,d)};var l=function(q){angular.forEach(o.organizaciones,function(s,r){if(s.nidEstructuraOrganizacion===q){o.organizacion=s}})};o.rangoPaginas=[5,10,20,100];o.currentPage=1;o.currentRango=o.rangoPaginas[0];o.maxSize=5;o.total=0;o.numPages=function(){return Math.ceil(o.total/o.currentRango)};o.$watch("currentPage + currentRango",function(){o.getUsuariosByPagina();o.row=(o.currentPage-1)*o.currentRango+1});var f=function(q){p.debug("Get paginacionUsuario - Success");console.log("Respuesta :: ",q);o.users=[];o.users=q.lista;o.total=q.total};var m=function(q){p.debug("Get paginacionUsuario - Error");console.log("Respuesta :: ",q)};o.getUsuariosByPagina=function(){var q={currentPage:o.currentPage,rango:o.currentRango,total:o.total,filtro:o.buscar};a.paginacionUsuario(q).then(f,m)};o.clickBuscar=function(){o.getUsuariosByPagina()};o.getEstructuraOrganizaciones();o.getUsuariosByPagina()}]);