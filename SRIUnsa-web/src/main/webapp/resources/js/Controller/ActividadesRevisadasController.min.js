
investigacionApp.controller("ActividadesRevisadasController",["$log","$scope","$location","ActividadesRevisadasService","SemestreService","TipoInvestigacionService","FondoConcursableService","TipoNivelService","EstructuraOrganizacionService","SharedService","SRIUnsaConfig","UsuarioFlujoService",function(p,n,j,s,a,w,k,o,r,m,A,h){n.sharedService=m;n.loader=false;n.loadTable=false;n.sharedService.scrollTop();var t=function(B){p.debug("GetTipoNivel - Success");console.log("Respuesta :: ",B);n.niveles=B;n.getEstructuraOrganizaciones()};var l=function(B){p.debug("GetTipoNivel - Error");console.log("Respuesta :: ",B)};var e=function(B){p.debug("GetEstructuraOrganizacion - Success");console.log("Respuesta :: ",B);angular.forEach(B,function(D,C){angular.forEach(B,function(F,E){if(D.nidPadre===F.nidEstructuraOrganizacion){D.nombrePadre=F.snombreEstructuraOrganizacion}});angular.forEach(n.niveles,function(F,E){if(D.nidTipoNivel===F.nidTipoNivel){D.nombreTipoNivel=F.snombreTipoNivel}})});n.estructuraOrganizaciones=B};var d=function(B){p.debug("GetEstructuraOrganizacion - Error");console.log("Respuesta :: ",B)};var z=function(B){p.debug("GetFondo - Success");console.log("Respuesta :: ",B);n.fondos=B};var i=function(B){p.debug("GetFondo - Error");console.log("Respuesta :: ",B)};var x=function(B){p.debug("GetTipoInvestigacion - Success");console.log("Respuesta :: ",B);n.tipoInvestigaciones=B};var c=function(B){p.debug("GetTipoInvestigacion - Error");console.log("Respuesta :: ",B)};var v=function(B){p.debug("GetSemestre - Success");console.log("Respuesta :: ",B);n.semestres=B};var u=function(B){p.debug("GetSemestre - Error");console.log("Respuesta :: ",B)};var q=function(B){p.debug("CreateAndGetUsuarioFlujo - Success");console.log("Respuesta :: ",B)};var y=function(B){p.debug("CreateAndGetUsuarioFlujo - Error");console.log("Respuesta :: ",B)};n.getListaTipoNivel=function(){o.getListaTipoNivel().then(t,l)};n.getEstructuraOrganizaciones=function(){r.getEstructuraOrganizaciones().then(e,d)};n.getFondos=function(){k.getFondos().then(z,i)};n.getSemestres=function(){a.getSemestres().then(v,u)};n.getTipoInvestigacion=function(){w.getInvestigaciones().then(x,c)};n.CrearOrActualizarUsuarioFlujo=function(){var B={nidFlujoActor:A.DIDE,nidUsuario:n.sharedService.idUsuario};h.CreateAndGetUsuarioFlujo(B).then(q,y)};n.facultadChange=function(){n.departamento={};n.escuela={}};n.departamentoChange=function(){n.escuela={}};n.rangoPaginas=[5,10,20,100];n.currentPage=1;n.currentRango=n.rangoPaginas[0];n.maxSize=5;n.total=0;n.numPages=function(){return Math.ceil(n.total/n.currentRango)};n.$watch("currentPage + currentRango",function(){n.getActividades();n.row=(n.currentPage-1)*n.currentRango+1});var g=function(){var B={nidTipoActividadInvestigacion:(n.tipoInvestigacion===null||n.tipoInvestigacion===undefined)?"":n.tipoInvestigacion.nidTipoActividadInvestigacion,sfacultad:(n.facultad===null||n.facultad===undefined)?"":n.facultad.snombreEstructuraOrganizacion,sdepartamento:(n.departamento===null||n.departamento===undefined)?"":n.departamento.snombreEstructuraOrganizacion,sescuela:(n.escuela===null||n.escuela===undefined)?"":n.escuela.snombreEstructuraOrganizacion,ssemestre:(n.semestre===null||n.semestre===undefined)?"":n.semestre.snombreSemestre,sfondoConcursable:(n.fondo===null||n.fondo===undefined)?"":n.fondo.snombreFondoConcursable};return B};var f=function(B){p.debug("GetActividadesRevisadas - Success");console.log("Respuesta :: ",B);n.actividadesRevisadas=B.lista;n.total=B.total;n.loadTable=false};var b=function(B){p.debug("GetActividadesRevisadas - Error");console.log("Respuesta :: ",B)};n.getActividades=function(){var B={currentPage:n.currentPage,rango:n.currentRango,total:n.total,idUsuario:n.sharedService.idUsuario,idEstado:A.REVISADO,idFlujoActor:A.DIUN,filtro:g()};s.GetActividadesRevisadas(B).then(f,b)};n.filtrar=function(){n.loadTable=true;setTimeout(function(){n.getActividades()},500)};n.getListaTipoNivel();n.getFondos();n.getSemestres();n.getTipoInvestigacion();n.CrearOrActualizarUsuarioFlujo();n.getActividades();n.verActividadById=function(B){n.loader=true;j.path("/actividad/Revisadas/"+B.idactividadinvestigacion)}}]);