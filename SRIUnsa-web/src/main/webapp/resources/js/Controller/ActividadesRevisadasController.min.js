
investigacionApp.controller("ActividadesRevisadasController",["$log","$scope","$location","ActividadesRevisadasService","SemestreService","TipoInvestigacionService","FondoConcursableService","TipoNivelService","EstructuraOrganizacionService","SharedService","SRIUnsaConfig","UsuarioFlujoService",function(o,m,i,r,a,u,j,n,q,l,y,h){m.sharedService=l;m.loader=false;m.loadTable=false;m.sharedService.scrollTop();m.departamentos=[];var e=function(z){o.debug("GetEstructuraOrganizacion - Success");console.log("Respuesta :: ",z);angular.forEach(z,function(B,A){if(m.sharedService.usuarioLogin.idFacultad===B.nidPadre){m.departamentos.push(B)}})};var d=function(z){o.debug("GetEstructuraOrganizacion - Error");console.log("Respuesta :: ",z)};var x=function(z){o.debug("GetFondo - Success");console.log("Respuesta :: ",z);m.fondos=z};var k=function(z){o.debug("GetFondo - Error");console.log("Respuesta :: ",z)};var v=function(z){o.debug("GetTipoInvestigacion - Success");console.log("Respuesta :: ",z);m.tipoInvestigaciones=z};var c=function(z){o.debug("GetTipoInvestigacion - Error");console.log("Respuesta :: ",z)};var t=function(z){o.debug("GetSemestre - Success");console.log("Respuesta :: ",z);m.semestres=z};var s=function(z){o.debug("GetSemestre - Error");console.log("Respuesta :: ",z)};var p=function(z){o.debug("CreateAndGetUsuarioFlujo - Success");console.log("Respuesta :: ",z)};var w=function(z){o.debug("CreateAndGetUsuarioFlujo - Error");console.log("Respuesta :: ",z)};m.getEstructuraOrganizaciones=function(){q.getEstructuraOrganizaciones().then(e,d)};m.getFondos=function(){j.getFondos().then(x,k)};m.getSemestres=function(){a.getSemestres().then(t,s)};m.getTipoInvestigacion=function(){u.getInvestigaciones().then(v,c)};m.CrearOrActualizarUsuarioFlujo=function(){var z={nidFlujoActor:y.DIDE,nidUsuario:m.sharedService.idUsuario};h.CreateAndGetUsuarioFlujo(z).then(p,w)};m.rangoPaginas=[5,10,20,100];m.currentPage=1;m.currentRango=m.rangoPaginas[0];m.maxSize=5;m.total=0;m.numPages=function(){return Math.ceil(m.total/m.currentRango)};m.$watch("currentPage + currentRango",function(){m.getActividades();m.row=(m.currentPage-1)*m.currentRango+1});var g=function(){var z={nidTipoActividadInvestigacion:(m.tipoInvestigacion===null||m.tipoInvestigacion===undefined)?"":m.tipoInvestigacion.nidTipoActividadInvestigacion,sfacultad:(m.facultad===null||m.facultad===undefined)?"":m.facultad.snombreEstructuraOrganizacion,sdepartamento:(m.departamento===null||m.departamento===undefined)?"":m.departamento.snombreEstructuraOrganizacion,sescuela:(m.escuela===null||m.escuela===undefined)?"":m.escuela.snombreEstructuraOrganizacion,ssemestre:(m.semestre===null||m.semestre===undefined)?"":m.semestre.snombreSemestre,sfondoConcursable:(m.fondo===null||m.fondo===undefined)?"":m.fondo.snombreFondoConcursable};return z};var f=function(z){o.debug("GetActividadesRevisadas - Success");console.log("Respuesta :: ",z);m.actividadesRevisadas=z.lista;m.total=z.total;m.loadTable=false};var b=function(z){o.debug("GetActividadesRevisadas - Error");console.log("Respuesta :: ",z)};m.getActividades=function(){var z={currentPage:m.currentPage,rango:m.currentRango,total:m.total,idUsuario:m.sharedService.idUsuario,idEstado:y.REVISADO,idFlujoActor:y.DIUN,filtro:g()};r.GetActividadesRevisadas(z).then(f,b)};m.filtrar=function(){m.loadTable=true;setTimeout(function(){m.getActividades()},500)};m.getFondos();m.getSemestres();m.getTipoInvestigacion();m.getEstructuraOrganizaciones();m.CrearOrActualizarUsuarioFlujo();m.getActividades();m.verActividadById=function(z){m.loader=true;i.path("/actividad/Revisadas/"+z.idactividadinvestigacion)}}]);