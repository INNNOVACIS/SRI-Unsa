
investigacionApp.controller("FlujoAristaController",["$log","$scope","ngToast","FlujoAristaService","FlujoActorService","EstadoService",function(k,j,l,h,q,s){j.flujoActores=[];var d=function(v){k.debug("GetActores - Success");console.log("Respuesta :: ",v);j.flujoActores=v};var a=function(v){k.debug("GetActores - Error");console.log("Respuesta :: ",v)};var t=function(v){k.debug("GetEstados - Success");console.log("Respuesta :: ",v);j.estados=v.body};var p=function(v){k.debug("GetEstados - Error");console.log("Respuesta :: ",v)};var m=function(v){k.debug("RegistrarFlujoArista - Success");console.log("Respuesta :: ",v);if(v!==-1){j.getFlujoAristaByPagina()}j.cancel();$("#modalNuevo").modal("toggle")};var o=function(v){k.debug("RegistrarFlujoArista - Error");console.log("Respuesta :: ",v);j.cancel()};var u=function(v){k.debug("ActualizarFlujoArista - Success");console.log("Respuesta :: ",v);if(v===true){j.getFlujoAristaByPagina()}j.cancel();$("#modalActualizar").modal("toggle")};var g=function(v){k.debug("ActualizarFlujoArista - Success");console.log("Respuesta :: ",v);j.cancel()};var f=function(v){k.debug("EliminarFlujoArista - Success");console.log("Respuesta :: ",v);if(v===true){j.getFlujoAristaByPagina()}j.cancel()};var b=function(v){k.debug("EliminarFlujoArista - Error");console.log("Respuesta :: ",v);j.cancel()};j.getFlujoActores=function(){q.getActores().then(d,a)};j.getEstados=function(){s.getEstados().then(t,p)};j.RegistrarFlujoArista=function(){j.submitted=true;if(j.formRegistrarFlujoArista.$valid&&j.formRegistrarFlujoArista.flujoActorOrigen.$valid&&j.formRegistrarFlujoArista.flujoActorDestino.$valid&&j.formRegistrarFlujoArista.estado.$valid){var v={sidFlujoActorDestino:j.flujoActorDestino.nidFlujoActor,sidFlujoActorOrigen:j.flujoActorOrigen.nidFlujoActor,snombreArista:j.flujoAristaNombre,nidEstado:j.estado.nidEstado,sflujo:"SRI",sestado:"A"};h.RegistrarFlujoArista(v).then(m,o);e("Registrado!","success")}else{console.log("No se registro  :: ",j.flujoActores);e("Error al registrar!","danger")}};j.ActualizarFlujoArista=function(){j.submitted=true;if(j.formUpdateFlujoArista.$valid){var v={nidArista:j.flujoAristaActor.nidArista,sidFlujoActorDestino:j.flujoActorDestino.nidFlujoActor,sidFlujoActorOrigen:j.flujoActorOrigen.nidFlujoActor,snombreArista:j.flujoAristaActor.snombreArista,nidEstado:j.estadoFlujo.nidEstado,sflujo:"SRI",sestado:"A"};h.ActualizarFlujoArista(v).then(u,g);e("Actualizado!","success")}else{console.log("Error al actualizar Flujo Arista  :: ",j.flujoActores);e("Error al actualizar!","danger")}};j.EliminarFlujoArista=function(v){j.flujoAristaActor=v;var w={nidArista:j.flujoAristaActor.nidArista,sidFlujoActorDestino:j.flujoAristaActor.nidActorDestino,sidFlujoActorOrigen:j.flujoAristaActor.nidActorOrigen,snombreArista:j.flujoAristaActor.snombreArista,sflujo:j.flujoAristaActor.sflujo,sestado:"I"};h.EliminarFlujoArista(w).then(f,b)};j.actualizar=function(v){console.log(j.flujoArista);j.flujoAristaActor=v;j.flujoActorOrigen=c(v.nidActorOrigen);j.flujoActorDestino=c(v.nidActorDestino);j.estadoFlujo=r(v.nidEstado)};var c=function(v){var w=null;angular.forEach(j.flujoActores,function(y,x){if(y.nidFlujoActor===v){w=y}});return w};var r=function(w){var v=null;angular.forEach(j.estados,function(y,x){if(y.nidEstado===w){v=y}});return v};j.cancel=function(){j.flujoAristaNombre=null;j.flujoActorOrigen=null;j.flujoActorDestino=null;j.estado=null};var e=function(w,v){l.create({className:v,content:'<span class="alert-link">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+w+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>"})};j.rangoPaginas=[5,10,20,100];j.currentPage=1;j.currentRango=j.rangoPaginas[0];j.maxSize=5;j.total=0;j.numPages=function(){return Math.ceil(j.total/j.currentRango)};j.$watch("currentPage + currentRango",function(){j.getFlujoAristaByPagina()});var n=function(v){k.debug("getFlujoAristaByPagina - Success");console.log("Response :: ",v);j.flujoAristas=[];j.flujoAristas=v.lista;j.total=v.total};var i=function(v){k.debug("getFlujoAristaByPagina - Error");console.log("Response :: ",v)};j.getFlujoAristaByPagina=function(){var v={currentPage:j.currentPage,rango:j.currentRango,total:j.total,filtro:j.buscar};h.getFlujoAristaByPagina(v).then(n,i)};j.clickBuscar=function(){j.getActoresByPagina()};j.getEstados();j.getFlujoActores();j.getFlujoAristaByPagina()}]);