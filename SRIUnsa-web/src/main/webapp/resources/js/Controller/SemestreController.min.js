
investigacionApp.controller("SemestreController",["$log","$scope","ngToast","SemestreService","SharedService",function(k,j,m,a,f){j.sharedService=f;j.semestres=[];j.semestre={};j.errorFecha=false;var q=function(s){k.debug("Get Semestre - Success");console.log("Respuesta :: ",s);j.semestre=s};var p=function(s){k.debug("Get Semestre - Error");console.log("Respuesta :: ",s)};var r=function(s){k.debug("Registrar Semestre - Success");console.log("Respuesta :: ",s);j.getSemestresByPagina();j.cancel();$("#popNuevoSemestre").modal("toggle")};var n=function(s){k.debug("Registrar Semestre - Error");console.log("Respuesta :: ",s);j.cancel()};var g=function(s){k.debug("Update Semestre - Success");console.log("Respuesta :: ",s);j.getSemestresByPagina();j.cancel();$("#popUpdateSemestre").modal("toggle")};var h=function(s){k.debug("Update Semestre - Error");console.log("Respuesta :: ",s);j.cancel()};var l=function(s){k.debug("DeleteSemestre - Success");console.log("Respuesta :: ",s);j.getSemestresByPagina();j.cancel()};var e=function(s){k.debug("DeleteSemestre - Error");console.log("Respuesta :: ",s);j.cancel()};j.getSemestres=function(){a.getSemestres().then(q,p)};j.registrarSemestre=function(){j.submitted=true;if(j.formRegistroSemestre.$valid){j.semestre.suserCreacion=j.sharedService.nombreUsuario;j.semestre.suserModificacion=j.sharedService.nombreUsuario;j.semestre.sestado="A";j.semestre.dinicioSemestre=j.fechaInicio;j.semestre.dfinSemestre=j.fechaFin;a.registrarSemestre(j.semestre).then(r,n);d("Registrado!","success")}else{console.log("No se registro Semestre :: ",j.semestre);d("Error al registrar!","danger");j.cancel()}};j.updateSemestre=function(){j.submitted=true;if(j.formUpdateSemestre.$valid){var s={};j.semestre.suserModificacion=j.sharedService.nombreUsuario;j.semestre.sestado="A";delete j.semestre.inicio;delete j.semestre.fin;a.updateSemestre(j.semestre).then(g,h);d("Actualizado!","success")}else{console.log("No se registro Semestre :: ",j.semestre);d("Error al actualizar!","danger");j.cancel()}};j.deleteSemestre=function(s){j.semestre=s;j.semestre.suserModificacion=j.sharedService.nombreUsuario;a.deleteSemestre(j.semestre).then(l,e)};j.update=function(s){angular.copy(s,j.semestre)};j.cancel=function(){j.semestre={};j.fechaInicio="";j.fechaFin="";j.errorFecha=false};j.changeFecha=function(){if(j.fechaFin<j.fechaInicio){console.log("Error");j.errorFecha=true}else{console.log("Success");j.errorFecha=false}};var d=function(t,s){m.create({className:s,content:'<span class="alert-link">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'+t+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>"})};j.rangoPaginas=[5,10,20,100];j.currentPage=1;j.currentRango=j.rangoPaginas[0];j.maxSize=5;j.total=0;j.numPages=function(){return Math.ceil(j.total/j.currentRango)};j.$watch("currentPage + currentRango",function(){j.getSemestresByPagina()});var i=function(s){k.debug("getSemestresByPagina - Success");console.log("Respuesta :: ",s);j.semestres=[];angular.forEach(s.lista,function(u,t){u.inicio=j.sharedService.dateToString(u.dinicioSemestre);u.fin=j.sharedService.dateToString(u.dfinSemestre)});j.semestres=s.lista;j.total=s.total};var c=function(s){k.debug("getSemestresByPagina - Error");console.log("Respuesta :: ",s)};j.getSemestresByPagina=function(){var s={currentPage:j.currentPage,rango:j.currentRango,total:j.total,filtro:j.buscar};a.getSemestresByPagina(s).then(i,c)};j.clickBuscar=function(){j.getSemestresByPagina()};j.getSemestresByPagina();j.today=function(){j.fechaRegistro=new Date()};j.today();j.inlineOptions={customClass:o,minDate:new Date()};j.dateOptions={dateDisabled:b,formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date(),startingDay:1,showWeeks:false,showButtonBar:false};function b(t){var s=t.date,u=t.mode;return u==="day"&&(s.getDay()===0||s.getDay()===6)}j.toggleMin=function(){j.inlineOptions.minDate=j.inlineOptions.minDate?null:new Date();j.dateOptions.minDate=j.inlineOptions.minDate};j.toggleMin();j.open1=function(){j.popup1.opened=true};j.open2=function(){j.popup2.opened=true};j.setDate=function(t,u,s){j.dtRegistro=new Date(t,u,s)};j.formats=["dd/MMMM/yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"];j.format=j.formats[0];j.altInputFormats=["M!/d!/yyyy"];j.popup1={opened:false};j.popup2={opened:false};function o(w){var s=w.date;var x=w.mode;if(x==="day"){var u=new Date(s).setHours(0,0,0,0);for(var t=0;t<j.events.length;t++){var v=new Date(j.events[t].date).setHours(0,0,0,0);if(u===v){return j.events[t].status}}}return""}}]);