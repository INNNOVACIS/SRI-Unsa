<div ng-show="loader" class="SRI-loader-open">
    <div class="SRI-loader"></div>
</div>
<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12" style="margin-top:20px;">
            <div class="panel panel-primary">
                <div class="panel-heading" style="font-weight: bold; text-transform:uppercase; line-height: 2;">
                    {{ nombreTipoActividad }}
<!--                    <button class="btn btn-danger btn-sm pull-right" ng-click="descargarPDF()">
                        <span class="glyphicon glyphicon-cloud-download"></span>
                        Descargar PDF
                    </button>-->
                </div>
                <div class="panel-body">
                    
                    <form name="actividadForm" novalidate class="form-horizontal">
                        <div class="row">
                            <div class="col-md-6" >
                                <div class="form-group">
                                    <label class="control-label col-md-4" >Director de Unidad : </label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ director}}</label>
                                </div>
                            </div>
                            <div class="col-md-6" >
                                <div class="form-group">
                                    <label class="control-label col-md-4">Fecha Registro :</label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ actividadInvestigacion.dfechaRegistro }}</label>
                                </div>
                            </div>
                            <div class="col-md-6" >
                                <div class="form-group">
                                    <label class="control-label col-md-4" >Nombre Docente : </label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ responsable }}</label>
                                </div>
                            </div>
                            <div class="col-md-6" >
                                <div class="form-group">
                                    <label class="control-label col-md-4">Semestre : </label>
                                    <label class="control-label col-md-8 SRI-text-default" style="text-transform:uppercase;">{{ actividadInvestigacion.ssemestre }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Facultad : </label>
                                    <label class="control-label col-md-8 SRI-text-default">{{ actividadInvestigacion.sfacultad }}</label>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4">Departamento : </label>
                                    <label class="control-label col-md-8 SRI-text-default">{{ actividadInvestigacion.sdepartamento }}</label>
                                </div>
                            </div>
                            
                            <div class="col-md-6" ng-show="mostrarActividad[2]">
                                <div class="form-group">
                                    <label class="control-label col-md-4">&Aacute;rea : </label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ actividadInvestigacion.sareaInvestigacion }}</label>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4"> Sub &aacute;rea : </label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ actividadInvestigacion.ssubAreaInvestigacion }}</label>
                                </div>
                                
                                <div class="form-group">
                                    <label class="control-label col-md-4"> Disciplina : </label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ actividadInvestigacion.sdisciplina }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="row" ng-show="mostrarActividad[3]">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2"> Tipo de Producci&oacute;n : </label>
                                    <label class="control-label col-md-10 SRI-text-default" >{{ actividadInvestigacion.sritipoProduccion }}</label>                                  
                                </div>
                            </div>
                            
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">Estado : </label>
                                    <label class="control-label col-md-10 SRI-text-default" >{{ actividadInvestigacion.sestadoProduccion }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2" >{{ tituloLabel }} : </label>
                                    <div class="col-md-10">
                                        <input ng-model="actividadInvestigacion.snombreActividadInvestigacion" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" ng-show="mostrarActividad[1]">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">Grado : </label>
                                    <label class="control-label col-md-10 SRI-text-default" >{{ actividadInvestigacion.stipoAsesoria }}</label>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">Nombre del Asesorado : </label>
                                    <div class="col-md-10">
                                        <input ng-model="actividadInvestigacion.snombreAsesorado" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">N° de Resoluci&oacute;n : </label>
                                    <div class="col-md-10">
                                        <input ng-model="actividadInvestigacion.snumeroContrato" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">Fecha de Resoluci&oacute;n : </label>
                                    <label class="control-label col-md-10 SRI-text-default" >{{ actividadInvestigacion.dfechaAceptacion }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="row" ng-show="mostrarActividad[2]">
<!--                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Rol : </label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ actividadInvestigacion.dfechaRegistro }}</label>
                                </div>
                            </div>-->
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Linea de Investigaci&oacute;n : </label>
                                    <div class="col-md-8">
                                        <input ng-model="actividadInvestigacion.slineaInvestigacion" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-4">N&uacute;mero de Contrato :</label>
                                    <div class="col-md-8">
                                        <input ng-model="actividadInvestigacion.snumeroContrato" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Fuente de Financiamiento :</label>
                                    <label class="control-label col-md-8 SRI-text-default" >{{ actividadInvestigacion.sfondoConcursable }}</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-4">Fecha de contrato o inicio del proyecto : </label>
<!--                                    <label class="control-label col-md-8 SRI-text-default" >{{ actividadInvestigacion.dfechaAceptacion }}</label>-->
                                    <div class="col-md-8">
                                        <p class="input-group">
                                            <input type="text" 
                                                   class="form-control" 
                                                   uib-datepicker-popup  
                                                   show-button-bar="false" 
                                                   ng-model="actividadInvestigacion.dfechaAceptacion" 
                                                   is-open="popupAceptacion.opened" 
                                                   datepicker-options="dateOptions" 
                                                   close-text="Close"
                                                   readonly/>
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default" ng-click="openAceptacion()"><i class="glyphicon glyphicon-calendar"></i></button>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" ng-show="mostrarActividad[3]">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">{{ fechaTipoProduccion }} : </label>
<!--                                    <label class="control-label col-md-10 SRI-text-default" >{{ actividadInvestigacion.s_fechaAceptacion }}</label>-->
                                    <div class="col-md-10">
                                        <p class="input-group">
                                            <input type="text" 
                                                   class="form-control" 
                                                   uib-datepicker-popup  
                                                   show-button-bar="false" 
                                                   ng-model="actividadInvestigacion.dfechaAceptacion" 
                                                   is-open="popupAceptacion.opened" 
                                                   datepicker-options="dateOptions" 
                                                   close-text="Close" 
                                                   readonly/>
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default" ng-click="openAceptacion()"><i class="glyphicon glyphicon-calendar"></i></button>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12" ng-show="pendiente || ejecucion">
                                <div class="form-group">
                                    <label class="control-label col-md-2">Plazo de Ejecuci&oacute;n : </label>
                                    <label class="control-label col-md-10 SRI-text-default" >{{ actividadInvestigacion.splazoEjecucion + " " + " meses." }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="row" ng-show="showVerificacion && realizado">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">{{ labelCodigo }} : </label>
                                    <div class="col-md-10">
                                        <input ng-model="actividadInvestigacion.scodigo" class="form-control">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2">{{ labelNombrePublicacion }} : </label>
                                    <div class="col-md-10">
                                        <input ng-model="actividadInvestigacion.snombrePublicacion" class="form-control">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <form class="form-horizontal" ng-show="showDescripcion">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2"> {{ descripcionLabel }} :</label>
                                    <div class="col-md-10">
                                        <textarea ng-model="actividadInvestigacion.sdescripcionActividad" style="margin-bottom: 4px;" class="form-control" rows="5" placeholder="Descripcion breve del problema"></textarea> 
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    
                    <form class="form-horizontal">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label class="control-label col-md-2"> Archivos adjuntos a la actividad</label>
                                    <div class="col-md-10">
                                        <div class="panel panel-default" >
                                            <div class="panel-body">
                                                <table width="100%" class="table table-striped table-bordered table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th width="40%">Nombre Archivo</th>
                                                            <th>Tipo</th>
                                                            <th>Acción</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="archivo in archivos">
                                                            <td><strong>{{ archivo.nombre }}</strong></td>
                                                            <td>{{ archivo.tipo }}</td>
                                                            <td nowrap>
                                                                <button type="button" class="btn btn-danger btn-xs" ng-click="descargarArchivo(archivo)">
                                                                    <span class="glyphicon glyphicon-download"></span> Descargar
                                                                </button>
                                                                <button type="button" class="btn btn-default btn-xs"
                                                                        data-toggle="modal" data-target="#modalConfirmarEliminacion"
                                                                        ng-click="eliminarAdjuntoRow(archivo)">
                                                                    <span class="glyphicon glyphicon-trash"></span> Eliminar
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <label for="inpFile" class="control-label col-md-2"> {{adjuntar}}</label>
                                        <div class="col-md-10" ng-class="{ 'has-error' : adjuntoIsValido && submitted}"> <!-- ng-class="{ 'has-error' : adjuntoValidacion}" -->
                                            <div class="panel panel-default" >
                                                <div class="panel-body">
                                                    <div class="col-md-2">
                                                        <label for="fileUpload" class="SRI-button"> Adjuntar </label>
                                                        <input id="fileUpload" 
                                                               name="inputFile" 
                                                               style="display:none;" 
                                                               type="file" 
                                                               nv-file-select=""
                                                               uploader="uploader"
                                                               max-size="20485760"
                                                               multiple
                                                               required/><br/>
                                                    </div>
                                                    <div class="col-md-9">
                                                        <table class="table" style="margin-bottom:0;">
                                                            <thead>
                                                                <tr>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="item in uploader.queue">
                                                                    <td width="60%"><strong>{{ item.file.name }}</strong></td>
                                                                    <td nowrap width="10%">{{ item.file.size/1024/1024|number:2 }} MB</td>
                                                                    <td>
                                                                        <div class="progress" style="margin-bottom: 0;">
                                                                            <div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
                                                                        </div>
                                                                    </td>
                                                                    <td nowrap width="10%">
                                                                        <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()">
                                                                            <span class="glyphicon glyphicon-trash"></span> Eliminar
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <div style="display:none;">
                                                        <div >
                                                            Progreso:
                                                            <div class="progress" style="">
                                                                <div class="progress-bar" role="progressbar" ng-style="{ 'width': uploader.progress + '%' }"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-1" ng-show="mostrarAyuda">
                                                        <button type="button" class="btn btn-danger btn-xs pull-right SRIUnsa-ayuda" data-toggle="modal" data-target="#visualizacion">
                                                            <span class="glyphicon glyphicon-question-sign"></span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12" ng-show="pendienteAdjunto">
                                    <div class="form-group">
                                        <label for="inpFile" class="control-label col-md-2"> {{ adjuntarOtros }}</label>
                                        <div class="col-md-10">
                                            <div class="panel panel-default" >
                                                <div class="panel-body">
                                                    <div class="col-md-2">
                                                        <label for="subirArchivo" class="SRI-button"> Adjuntar </label>
                                                        <input id="subirArchivo" 
                                                               style="display:none;" 
                                                               type="file" 
                                                               nv-file-select="" 
                                                               uploader="uploader2" 
                                                               multiple  /><br/>
        <!--                                                    <p>Número de Archivos: {{ uploader.queue.length }}</p>-->
                                                    </div>
                                                    <div class="col-md-9">
                                                        <table class="table" style="margin-bottom:0;">
                                                            <thead>
                                                                <tr></tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr ng-repeat="item in uploader2.queue">
                                                                    <td width="60%"><strong>{{ item.file.name }}</strong></td>
                                                                    <td nowrap width="10%">{{ item.file.size/1024/1024|number:2 }} MB</td>
                                                                    <td>
                                                                        <div class="progress" style="margin-bottom: 0;">
                                                                            <div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
                                                                        </div>
                                                                    </td>
                                                                    <td nowrap width="10%">
                                                                        <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()">
                                                                            <span class="glyphicon glyphicon-trash"></span> Eliminar
                                                                        </button>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <div class="col-md-1" ng-show="mostrarAyuda">
                                                        <button type="button" class="btn btn-danger btn-xs pull-right SRIUnsa-ayuda" data-toggle="modal" data-target="#modalFicha">
                                                            <span class="glyphicon glyphicon-question-sign"></span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="form-group">
                                        <button class="col-md-offset-2 btn btn-primary" type="button" 
                                                data-toggle="modal" data-target="#modalConfirmarActualizacion">
                                            <span class="glyphicon glyphicon-refresh"></span> Actualizar
                                        </button>
                                        <button class="btn btn-primary" type="button" ng-click="irBandejaRevisados()">
                                            <span class="glyphicon glyphicon-arrow-right"></span> Ir a Bandeja
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>	
        </div>
    </div>
</div>

<div id="modalConfirmarActualizacion" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Confirmaci&oacute;n de Actualizaci&oacute;n</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <form novalidate class="form-horizontal">
                            <p>Esta seguro que desea actualizar su actividad de investigaci&oacute;.</p>
                            <p>¡Gracias!.</p>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" 
                        class="btn btn-primary btn-sm" 
                        data-dismiss="modal" 
                        ng-click="actualizarActividadInvestigacion()">
                    <span class="glyphicon glyphicon-floppy-saved"></span>
                    Actualizar
                </button>
                <button type="button" class="btn btn-deafult btn-sm" data-dismiss="modal">
                    <span class="glyphicon glyphicon-remove"></span>
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<div id="modalConfirmarEliminacion" class="modal fade">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Confirmar Eliminaci&oacute;n</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <form novalidate class="form-horizontal">
                            <p>Esta seguro que desea eliminar el archivo Adjunto, este no se podr&aacute; recuperar.</p>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" ng-click="eliminarAdjunto()">
                    <span class="glyphicon glyphicon-trash"></span>
                    Eliminar
                </button>
                <button type="button" class="btn btn-deafult btn-sm" data-dismiss="modal" ng-click="cancel()">
                    <span class="glyphicon glyphicon-remove"></span>
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>